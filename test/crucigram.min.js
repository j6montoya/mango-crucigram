var Crucigram=function(){function e(e){this.originWords=null,this.updater=null,this.arrWords=[],this.score=0,this.mark=e.mark,this.attrMark=e.attrMark||"data-mark",this.clsMark=e.clsMark||"textMark",this.words=e.words,this.check=e.check,this.press=e.press,this.originBackground=e.originBackground,this.pressBackground=e.pressBackground,this.point=e.point||1,this.finishGame=e.finishGame,this.finishTime=e.finishTime,this.minimum=e.minimum||this.size(this.words),this.minutes=e.minutes||20,this.time=e.time||!1,this.timerId=e.timerId||"timer"}return e.prototype.indexOf=function(e,t){var n,r;n=0;for(r=0,l=e.length;r<l;++r)t==e[r]&&(n=r);return n},e.prototype.size=function(e){var t,n;n=0;for(t in e)e.hasOwnProperty(t)&&++n;return n},e.prototype.organize=function(){var e;this.originWords=this.words;for(e in this.words)this.words.hasOwnProperty(e)&&(this.words[e].word=this.words[e].word.split(""))},e.prototype.pressKey=function(){var e,t,n,r,i,s;e=this,t=document.getElementsByClassName(this.press);for(r=0,n=t.length;r<n;++r)t[r].style.backgroundColor=this.originBackground,t[r].onclick=function(){i=this,this.style.backgroundColor=e.pressBackground,this.tabIndex=e.indexOf(t,this),this.focus(),this.onblur=function(){i.style.backgroundColor=e.originBackground},this.onkeydown=function(e){e=e||window.event,s=e.keyCode||e.chartCode||e.which,s>=65&&s<=90?i.innerHTML=String.fromCharCode(s):e.returnValue=!1}}},e.prototype.checkWords=function(){var e,t;e=this,t=document.getElementsByClassName(this.check)[0],t.onclick=function(){return e.confirm()}},e.prototype.confirm=function(){var e,t,n,r,i,s,o,u,a,f,l,c;e=this;for(t in e.words)if(e.words.hasOwnProperty(t)){n=document.getElementsByClassName(t),r=e.words[t].word,i=[];for(var l=0,c=n.length;l<c;++l)_x=n[l].innerHTML,i.push(_x);r=r.join(""),i=i.join("");if(r==i){e.score=e.score+e.point,e.arrWords.push(r);if(e.words[t].mark===!0){s=document.getElementsByClassName(e.mark);for(o=0,u=s.length;o<u;++o)a=s[o].getAttribute(e.attrMark),a===t&&(s[o].className=s[o].className+" "+e.clsMark,s[o].innerHTML=r)}delete e.words[t],f=document.getElementsByClassName(t),l=0,c=f.length;while(l<c)f[l].onkeydown=null,f[l].onclick=null,++l}else{f=document.getElementsByClassName(t),l=0,c=f.length;while(l<c)f[l].style.backgroundColor=e.originBackground,++l}}e.arrWords.length>=e.minimum&&(e.time===!0&&(document.getElementById(e.timerId).innerHTML="00:00",clearInterval(e.updater)),e.finishGame(e.score,e.arrWords))},e.prototype.start=function(){this.organize(),this.pressKey(),this.checkWords(),this.time===!0&&this.timer()},e.prototype.timer=function(){var e,t,n,r,i,s,o,u,a,f,l,c;this.minutes<=59&&this.minutes>=1&&(e=this,t=6e4*this.minutes,n=new Date,n=n.getTime()+t,r=function(){return a=new Date,a=a.getTime(),l=Math.floor((n-a)/1e3/60),f=Math.round((n-a)/1e3-60*l),f=f==60?59:f,s=f===0?"00":f<10?"0"+f.toString():f.toString(),o=l===0?"00":l<10?"0"+l.toString():l.toString(),u=o+":"+s,{minutes:o,seconds:s,timerText:u,realSecond:f,realMinute:l}},i=function(){c=r(),document.getElementById(e.timerId).innerHTML=c.timerText,c.realMinute===0&&c.realSecond===1&&(document.getElementById(e.timerId).innerHTML="00:00",e.confirm(),e.finishTime(e.score,e.arrWords),clearInterval(e.updater))},e.updater=setInterval(i,1e3))},e}();window.Crucigram=Crucigram